knitr::opts_chunk$set(echo = TRUE)
ggplot(storms, aes(x=`Wind(WMO)`, y = `Pres(WMO)`, col= Nature)) + geom_point() + scale_color_manual(labels = c("Disturbance", "Extratropical", "Conflicting Reports", "Not Reported", "Sub tropical","Tropical Storm"), values = c("purple", "blue","green", "red","orange","yellow"))
ggplot(storms, aes(x=`Wind(WMO)`, y = `Pres(WMO)`, col= Nature)) + geom_point() + scale_color_manual(labels = c("Disturbance", "Extratropical", "Conflicting Reports", "Not Reported", "Sub tropical","Tropical Storm"), values = c("purple", "blue","green", "red","orange","yellow"))
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(dplyr)
library(kableExtra)
library(lubridate)
library(ggplot2)
getwd()
storms <- read_csv("../data/ibtracs-2010-2015.csv",  na = c(-999.0, "-1.0", "0.0","-1", "0"))
kable(sample_n(storms, 5))
length(unique(storms$Name))
storms10 = filter(storms, Season == 2010)
length(unique(storms10$Name))
storms11 = filter(storms, Season == 2011)
length(unique(storms11$Name))
storms12 = filter(storms, Season == 2012)
length(unique(storms12$Name))
storms13 = filter(storms, Season == 2013)
length(unique(storms13$Name))
storms14 = filter(storms, Season == 2014)
length(unique(storms14$Name))
storms15 = filter(storms, Season == 2015)
length(unique(storms15$Name))
stormsSouth = filter(storms, Latitude < 0)
length(unique(stormsSouth$Name))
stormsNorth = filter(storms, Latitude > 0)
length(unique(stormsNorth$Name))
storms10n = filter(storms, Season == 2010, Latitude > 0)
length(unique(storms10n$Name))
storms11n = filter(storms, Season == 2011, Latitude > 0)
length(unique(storms11n$Name))
storms12n = filter(storms, Season == 2012, Latitude > 0)
length(unique(storms12n$Name))
storms13n = filter(storms, Season == 2013, Latitude > 0)
length(unique(storms13n$Name))
storms14n = filter(storms, Season == 2014, Latitude > 0)
length(unique(storms14n$Name))
storms15n = filter(storms, Season == 2015, Latitude > 0)
length(unique(storms15n$Name))
storms10s = filter(storms, Season == 2010, Latitude < 0)
length(unique(storms10s$Name))
storms11s = filter(storms, Season == 2011, Latitude < 0)
length(unique(storms11s$Name))
storms12s = filter(storms, Season == 2012, Latitude < 0)
length(unique(storms12s$Name))
storms13s = filter(storms, Season == 2013, Latitude < 0)
length(unique(storms13s$Name))
storms14s = filter(storms, Season == 2014, Latitude < 0)
length(unique(storms14s$Name))
storms15s = filter(storms, Season == 2015, Latitude < 0)
length(unique(storms15s$Name))
unique(storms$Basin)
stormsSI = filter(storms, Basin == "SI")
length(unique(stormsSI$Name))
stormsSP = filter(storms, Basin == "SP")
length(unique(stormsSP$Name))
stormsWP = filter(storms, Basin == "WP")
length(unique(stormsWP$Name))
stormsSA = filter(storms, Basin == "SA")
length(unique(stormsSA$Name))
stormsNI = filter(storms, Basin == "NI")
length(unique(stormsNI$Name))
stormsEP = filter(storms, Basin == "EP")
length(unique(stormsEP$Name))
stormsNA = filter(storms, Basin == "NA")
length(unique(stormsNA$Name))
time = mdy_hm(storms$ISO_time)
storms["month"] = month(time)
storms1 = filter(storms, month == 1)
length(unique(storms1$Name))
storms2 = filter(storms, month == 2)
length(unique(storms2$Name))
storms3 = filter(storms, month == 3)
length(unique(storms3$Name))
storms4 = filter(storms, month == 4)
length(unique(storms4$Name))
storms5 = filter(storms, month == 5)
length(unique(storms5$Name))
storms6 = filter(storms, month == 6)
length(unique(storms6$Name))
storms7 = filter(storms, month == 7)
length(unique(storms7$Name))
storms8 = filter(storms, month == 8)
length(unique(storms8$Name))
storms9 = filter(storms, month == 9)
length(unique(storms9$Name))
storms10 = filter(storms, month == 10)
length(unique(storms10$Name))
storms11 = filter(storms, month == 11)
length(unique(storms11$Name))
storms12 = filter(storms, month == 12)
length(unique(storms12$Name))
uniqNames <- unique(storms$Name)
total = 0
len <- length(uniqNames)
stormsBad <-  c()
for (i in 1:length(uniqNames)){
nextStorm <- uniqNames[i]
stormName <- filter(storms, Name == nextStorm)
timeDifference <- mdy_hm(tail(stormName, 1)$ISO_time) - mdy_hm(head(stormName, 1)$ISO_time)
if (timeDifference > 60){
stormsBad <- append(stormsBad, nextStorm)
len <- len - 1
}else{
total <- total + as.double(timeDifference)
}
}
averageLength <- total / len
averageLength
stormsBad
storms10 <- filter(storms, Season == 2010)
uniqNames <- unique(storms10$Name)
total <- 0
len <- length(uniqNames)
for (i in 1:length(uniqNames)){
nextStorm <- uniqNames[i]
stormName <- filter(storms10, Name == nextStorm)
timeDifference <- mdy_hm(tail(stormName, 1)$ISO_time) - mdy_hm(head(stormName, 1)$ISO_time)
if (timeDifference > 60){
len <- len - 1
}else{
total <- total + as.double(timeDifference)
}
}
averageLength <- total / len
averageLength
df <- data.frame(2010, averageLength)
names(df)<-c("Year","Average_Duration")
df
storms11 <- filter(storms, Season == 2011)
uniqNames <- unique(storms11$Name)
total <- 0
len <- length(uniqNames)
for (i in 1:length(uniqNames)){
nextStorm <- uniqNames[i]
stormName <- filter(storms11, Name == nextStorm)
timeDifference <- mdy_hm(tail(stormName, 1)$ISO_time) - mdy_hm(head(stormName, 1)$ISO_time)
if (timeDifference > 60){
len <- len - 1
}else{
total <- total + as.double(timeDifference)
}
}
averageLength <- total / len
averageLength
dfNew <- data.frame(2011, averageLength)
names(dfNew)<-c("Year","Average_Duration")
df <- rbind(df, dfNew)
df
storms12 <- filter(storms, Season == 2012)
uniqNames <- unique(storms12$Name)
total <- 0
len <- length(uniqNames)
for (i in 1:length(uniqNames)){
nextStorm <- uniqNames[i]
stormName <- filter(storms12, Name == nextStorm)
timeDifference <- mdy_hm(tail(stormName, 1)$ISO_time) - mdy_hm(head(stormName, 1)$ISO_time)
if (timeDifference > 60){
len <- len - 1
}else{
total <- total + as.double(timeDifference)
}
}
averageLength <- total / len
averageLength
dfNew <- data.frame(2012, averageLength)
names(dfNew)<-c("Year","Average_Duration")
df <- rbind(df, dfNew)
df
storms13 <- filter(storms, Season == 2013)
uniqNames <- unique(storms13$Name)
total <- 0
len <- length(uniqNames)
for (i in 1:length(uniqNames)){
nextStorm <- uniqNames[i]
stormName <- filter(storms13, Name == nextStorm)
timeDifference <- mdy_hm(tail(stormName, 1)$ISO_time) - mdy_hm(head(stormName, 1)$ISO_time)
if (timeDifference > 80){
len <- len - 1
}else{
total <- total + as.double(timeDifference)
}
}
averageLength <- total /len
averageLength
dfNew <- data.frame(2013, averageLength)
names(dfNew)<-c("Year","Average_Duration")
df <- rbind(df, dfNew)
df
storms14 <- filter(storms, Season == 2014)
uniqNames <- unique(storms14$Name)
total <- 0
len <- length(uniqNames)
for (i in 1:length(uniqNames)){
nextStorm <- uniqNames[i]
stormName <- filter(storms14, Name == nextStorm)
timeDifference <- mdy_hm(tail(stormName, 1)$ISO_time) - mdy_hm(head(stormName, 1)$ISO_time)
if (timeDifference > 60){
len <- len - 1
}else{
total <- total + as.double(timeDifference)
}
}
averageLength <- total / length(uniqNames)
averageLength
dfNew <- data.frame(2014, averageLength)
names(dfNew)<-c("Year","Average_Duration")
df <- rbind(df, dfNew)
df
storms15 <- filter(storms, Season == 2015)
uniqNames <- unique(storms15$Name)
total <- 0
len <- length(uniqNames)
for (i in 1:length(uniqNames)){
nextStorm <- uniqNames[i]
stormName <- filter(storms15, Name == nextStorm)
timeDifference <- mdy_hm(tail(stormName, 1)$ISO_time) - mdy_hm(head(stormName, 1)$ISO_time)
if (timeDifference > 60){
len <- len - 1
}else{
total <- total + as.double(timeDifference)
}
}
averageLength <- total / length(uniqNames)
averageLength
dfNew <- data.frame(2015, averageLength)
names(dfNew)<-c("Year","Average_Duration")
df <- rbind(df, dfNew)
df
p<-ggplot(data=df, aes(x=Year, y=Average_Duration, fill = Year)) +
geom_bar(stat="identity") + theme_minimal()
p
stormsWindSpeed <- select(storms, c("Name", "Wind(WMO)"))
stormsWindSpeed <- aggregate(`Wind(WMO)` ~ Name, stormsWindSpeed, max)
stormsWindSpeed <- arrange(stormsWindSpeed, desc(`Wind(WMO)`))
top10WindSpeeds <- head(stormsWindSpeed,10)
kable(top10WindSpeeds)
stormsPres <- select(storms, c("Name", "Pres(WMO)"))
stormsPres <- aggregate(`Pres(WMO)` ~ Name, stormsPres, max)
stormsPres <- arrange(stormsPres, desc(`Pres(WMO)`))
top10WindSpeeds <- head(stormsPres,10)
kable(top10WindSpeeds)
ggplot(storms, aes(x=`Wind(WMO)`, y = `Pres(WMO)`, col= Nature)) + geom_point() + scale_color_manual(labels = c("Disturbance", "Extratropical", "Conflicting Reports", "Not Reported", "Sub tropical","Tropical Storm"), values = c("purple", "blue","green", "red","orange","yellow"))
knitr::include_graphics("../images/map-ep-na-storms-by-month.png")
p<-ggplot(data=df, aes(x=Year, y=Average_Duration, fill = Year)) +
geom_bar(stat="identity") + theme_minimal()
p
knitr::include_graphics("../images/map-all-storms.png")
ggplot(storms, aes(x=`Wind(WMO)`, y = `Pres(WMO)`, col= Nature)) + geom_point() + scale_color_manual(labels = c("Disturbance", "Extratropical", "Conflicting Reports", "Not Reported", "Sub tropical","Tropical Storm"), values = c("purple", "blue","green", "red","orange","yellow")) +
geom_smooth(method='lm')
ggplot(storms, aes(x=`Wind(WMO)`, y = `Pres(WMO)`)) + geom_point()  +geom_smooth(method='lm')
